<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>dubaaai | render-lab</title>
    <style>
        :root {
            --pink: #e6bbc7;
            --pink-glow: rgba(230, 187, 199, 0.4);
            --glass: rgba(255, 255, 255, 0.03);
            --border: rgba(255, 255, 255, 0.12);
            --bg: #050505;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Inter', sans-serif; }
        body { background: var(--bg); color: white; min-height: 100vh; display: flex; align-items: center; justify-content: center; overflow: hidden; }

        .orb { position: absolute; width: 600px; height: 600px; background: radial-gradient(circle, rgba(230, 187, 199, 0.1) 0%, transparent 70%); filter: blur(80px); border-radius: 50%; z-index: -1; animation: float 20s infinite alternate ease-in-out; }
        @keyframes float { 0% { transform: translate(-5%, -5%); } 100% { transform: translate(5%, 10%); } }

        .studio-card {
            background: var(--glass); backdrop-filter: blur(50px);
            border: 1px solid var(--border); padding: 50px;
            border-radius: 40px; width: 90%; max-width: 900px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.5);
            position: relative; z-index: 10;
        }

        .layout { display: grid; grid-template-columns: 1fr 1fr; gap: 40px; margin-top: 30px; }
        .brand-pill { background: rgba(230, 187, 199, 0.1); color: var(--pink); font-size: 10px; padding: 6px 15px; border-radius: 100px; letter-spacing: 3px; text-transform: uppercase; border: 1px solid rgba(230, 187, 199, 0.2); display: inline-block; }

        textarea {
            width: 100%; height: 350px; background: rgba(0,0,0,0.4);
            border: 1px solid var(--border); border-radius: 25px;
            padding: 20px; color: #888; font-family: 'monospace';
            font-size: 12px; outline: none; transition: 0.3s; resize: none;
        }
        textarea:focus { border-color: var(--pink); color: white; box-shadow: 0 0 20px var(--pink-glow); }

        .output-container {
            width: 100%; height: 350px; background: rgba(255,255,255,0.02);
            border: 1px solid var(--border); border-radius: 25px;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            position: relative; overflow: hidden;
        }

        /* The rendered image result */
        #final-render { max-width: 90%; max-height: 90%; cursor: context-menu; transition: 0.5s; display: none; }
        #final-render.active { display: block; animation: fadeIn 0.5s ease; }

        .hint-text { font-size: 10px; color: #555; text-transform: uppercase; letter-spacing: 2px; margin-top: 15px; text-align: center; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        #loader { display: none; border: 2px solid transparent; border-top: 2px solid var(--pink); border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
    </style>
</head>
<body>

    <div class="orb"></div>
    
    <div class="studio-card">
        <div class="brand-pill">Asset Engine</div>
        <h1 style="font-weight: 200; margin-top: 10px; font-size: 32px;">Render Lab</h1>
        
        <div class="layout">
            <textarea id="svg-input" placeholder="Paste <svg> markup here..." oninput="handleInput()"></textarea>
            
            <div class="output-container">
                <div id="loader"></div>
                <img id="final-render" alt="Right click to save">
                <div id="hint" class="hint-text">Awaiting Input</div>
            </div>
        </div>
    </div>

    <canvas id="stage" style="display:none"></canvas>

    <script>
        let timer;
        const input = document.getElementById('svg-input');
        const img = document.getElementById('final-render');
        const hint = document.getElementById('hint');
        const loader = document.getElementById('loader');
        const canvas = document.getElementById('stage');
        const ctx = canvas.getContext('2d');

        function handleInput() {
            clearTimeout(timer);
            const val = input.value.trim();
            if (!val.includes('<svg')) return;

            // Wait until user stops typing
            timer = setTimeout(() => render(val), 600);
        }

        async function render(svgMarkup) {
            hint.innerText = "Processing Grid...";
            img.classList.remove('active');
            loader.style.display = 'block';

            try {
                // 1. Create a virtual image from SVG
                const svgBlob = new Blob([svgMarkup], {type: 'image/svg+xml;charset=utf-8'});
                const url = URL.createObjectURL(svgBlob);
                const tempImg = new Image();

                tempImg.onload = () => {
                    // 2. Setup Canvas Dimensions (Default to 512 if not specified)
                    canvas.width = tempImg.width || 512;
                    canvas.height = tempImg.height || 512;
                    
                    // 3. Draw SVG to Canvas
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    ctx.drawImage(tempImg, 0, 0);

                    // 4. Convert to Data URL (High Quality PNG/GIF format)
                    const resultUrl = canvas.toDataURL("image/png");
                    
                    // 5. Update UI
                    img.src = resultUrl;
                    img.classList.add('active');
                    loader.style.display = 'none';
                    hint.innerText = "Right Click -> Save Image As";
                    
                    URL.revokeObjectURL(url);
                };

                tempImg.onerror = () => {
                    throw new Error("Invalid SVG Path");
                };

                tempImg.src = url;

            } catch (err) {
                loader.style.display = 'none';
                hint.innerText = "Error: Invalid SVG Structure";
            }
        }
    </script>
</body>
</html>