<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>dubaaai | sonic-glass</title>
    <style>
        :root {
            --pink: #e6bbc7;
            --pink-glow: rgba(230, 187, 199, 0.3);
            --glass: rgba(255, 255, 255, 0.04);
            --border: rgba(255, 255, 255, 0.1);
            --bg: #050505;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Inter', sans-serif; }
        body { background: var(--bg); color: white; height: 100vh; display: flex; overflow: hidden; }

        /* Background Visuals */
        .bg-glow { position: absolute; width: 100%; height: 100%; z-index: -1; background: radial-gradient(circle at 50% 50%, rgba(230, 187, 199, 0.05) 0%, transparent 50%); filter: blur(100px); }

        /* Sidebar - Glass Nav */
        aside {
            width: 300px; background: rgba(0,0,0,0.4); backdrop-filter: blur(40px);
            border-right: 1px solid var(--border); padding: 50px 30px;
            display: flex; flex-direction: column; gap: 40px;
        }

        .logo { font-size: 18px; letter-spacing: 6px; color: var(--pink); text-transform: uppercase; font-weight: 200; }
        .nav-btn { background: var(--pink); color: black; border: none; padding: 12px; border-radius: 100px; font-weight: 800; font-size: 10px; cursor: pointer; text-transform: uppercase; }

        #playlist-results { margin-top: 20px; overflow-y: auto; flex-grow: 1; }
        .pl-card { padding: 12px; font-size: 13px; color: #777; cursor: pointer; border-bottom: 1px solid rgba(255,255,255,0.05); transition: 0.3s; }
        .pl-card:hover { color: var(--pink); background: var(--glass); border-radius: 8px; }

        /* Main Workspace */
        main { flex: 1; display: flex; flex-direction: column; align-items: center; padding: 40px; position: relative; }

        /* YOUR CUSTOM SEARCH BAR (Matching the screenshot) */
        .search-wrapper { width: 100%; max-width: 800px; margin-bottom: 60px; }
        .search-input {
            width: 100%; background: var(--glass); border: 1px solid var(--border);
            padding: 22px 40px; border-radius: 20px; color: white; outline: none;
            backdrop-filter: blur(25px); font-size: 18px; font-weight: 200;
            transition: 0.5s cubic-bezier(0.4, 0, 0.2, 1); text-align: center;
        }
        .search-input:focus { border-color: var(--pink); box-shadow: 0 0 40px var(--pink-glow); background: rgba(255,255,255,0.08); }

        /* Giant Player Hub */
        .giant-player {
            width: 100%; max-width: 900px; height: 500px;
            background: var(--glass); backdrop-filter: blur(80px);
            border: 1px solid var(--border); border-radius: 40px;
            display: flex; align-items: center; justify-content: center;
            box-shadow: 0 40px 100px rgba(0,0,0,0.6);
            overflow: hidden;
        }

        #spotify-frame { width: 100%; height: 100%; border: none; display: none; }
        .placeholder-text { font-size: 12px; color: #444; letter-spacing: 4px; text-transform: uppercase; }
    </style>
</head>
<body>

    <div class="bg-glow"></div>

    <aside>
        <div class="logo">SONIC.IO</div>
        <button id="auth-btn" class="nav-btn" onclick="login()">Connect Spotify</button>
        <div id="playlist-results">
            <p style="font-size: 10px; color: #333; letter-spacing: 1px;">LIBRARY OFFLINE</p>
        </div>
    </aside>

    <main>
        <div class="search-wrapper">
            <input type="text" id="search" class="search-input" placeholder="Search the Spotify library..." onkeypress="handleSearch(event)">
        </div>

        <div class="giant-player" id="player-container">
            <div class="placeholder-text" id="status-msg">Awaiting Neural Link</div>
            <iframe id="spotify-frame" src="" allow="encrypted-media"></iframe>
        </div>
    </main>

    <script>
        const CLIENT_ID = 'bf11ddaca30a45ed82247a01026b0dd6'; // <--- PUT YOUR ID HERE
        const REDIRECT_URI = window.location.origin + window.location.pathname;

        // 1. Spotify Auth
        function login() {
            const scope = 'playlist-read-private user-library-read';
            const url = `https://accounts.spotify.com/authorize?client_id=${CLIENT_ID}&response_type=token&redirect_uri=${encodeURIComponent(REDIRECT_URI)}&scope=${encodeURIComponent(scope)}&show_dialog=true`;
            window.location.href = url;
        }

        // 2. Capture Token
        const hash = window.location.hash.substring(1);
        const params = new URLSearchParams(hash);
        const token = params.get('access_token');

        if (token) {
            document.getElementById('auth-btn').innerText = "LINKED";
            document.getElementById('status-msg').innerText = "CONNECTED TO GRID";
            loadPlaylists();
        }

        // 3. Import Playlists
        async function loadPlaylists() {
            const response = await fetch('https://api.spotify.com/v1/me/playlists', {
                headers: { 'Authorization': `Bearer ${token}` }
            });
            const data = await response.json();
            const list = document.getElementById('playlist-results');
            list.innerHTML = '<h4 style="font-size:10px; margin-bottom:15px; color:#555;">MY PLAYLISTS</h4>';
            
            data.items.forEach(pl => {
                const div = document.createElement('div');
                div.className = 'pl-card';
                div.innerText = pl.name.toUpperCase();
                div.onclick = () => {
                    document.getElementById('spotify-frame').src = `https://open.spotify.com/embed/playlist/${pl.id}`;
                    document.getElementById('spotify-frame').style.display = 'block';
                    document.getElementById('status-msg').style.display = 'none';
                };
                list.appendChild(div);
            });
        }

        // 4. Search & Play
        async function handleSearch(e) {
            if (e.key === 'Enter' && token) {
                const query = e.target.value;
                const response = await fetch(`https://api.spotify.com/v1/search?q=${encodeURIComponent(query)}&type=track&limit=1`, {
                    headers: { 'Authorization': `Bearer ${token}` }
                });
                const data = await response.json();
                const track = data.tracks.items[0];

                if (track) {
                    const player = document.getElementById('spotify-frame');
                    player.src = `https://open.spotify.com/embed/track/${track.id}`;
                    player.style.display = 'block';
                    document.getElementById('status-msg').style.display = 'none';
                }
            } else if (e.key === 'Enter' && !token) {
                alert("Please connect Spotify first!");
            }
        }
    </script>
</body>
</html>