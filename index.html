<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>dubaaai | render-lab</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gif.js/0.2.0/gif.js"></script>
    <style>
        :root {
            --pink: #e6bbc7;
            --pink-glow: rgba(230, 187, 199, 0.4);
            --glass: rgba(255, 255, 255, 0.03);
            --border: rgba(255, 255, 255, 0.12);
            --bg: #050505;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Inter', sans-serif; }
        body { background: var(--bg); color: white; min-height: 100vh; display: flex; align-items: center; justify-content: center; overflow: hidden; }

        .orb { position: absolute; width: 600px; height: 600px; background: radial-gradient(circle, rgba(230, 187, 199, 0.1) 0%, transparent 70%); filter: blur(80px); border-radius: 50%; z-index: -1; animation: float 20s infinite alternate ease-in-out; }
        @keyframes float { 0% { transform: translate(-5%, -5%); } 100% { transform: translate(5%, 10%); } }

        .studio-card {
            background: var(--glass); backdrop-filter: blur(50px);
            border: 1px solid var(--border); padding: 50px;
            border-radius: 40px; width: 90%; max-width: 900px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.5);
        }

        .layout { display: grid; grid-template-columns: 1fr 1fr; gap: 40px; margin-top: 30px; }

        .brand-pill { background: rgba(230, 187, 199, 0.1); color: var(--pink); font-size: 10px; padding: 6px 15px; border-radius: 100px; letter-spacing: 3px; text-transform: uppercase; border: 1px solid rgba(230, 187, 199, 0.2); display: inline-block; }

        textarea {
            width: 100%; height: 350px; background: rgba(0,0,0,0.4);
            border: 1px solid var(--border); border-radius: 25px;
            padding: 20px; color: #888; font-family: 'monospace';
            font-size: 12px; outline: none; transition: 0.3s; resize: none;
        }
        textarea:focus { border-color: var(--pink); color: white; box-shadow: 0 0 20px var(--pink-glow); }

        .output-container {
            width: 100%; height: 350px; background: rgba(255,255,255,0.02);
            border: 1px solid var(--border); border-radius: 25px;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            position: relative; overflow: hidden;
        }

        #final-image { max-width: 80%; max-height: 80%; display: none; cursor: context-menu; transition: 0.5s; }
        #final-image.visible { display: block; animation: fadeInUp 0.8s ease; }

        .hint-text { font-size: 10px; color: #555; text-transform: uppercase; letter-spacing: 2px; margin-top: 15px; }
        
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        #loader { display: none; border: 2px solid transparent; border-top: 2px solid var(--pink); border-radius: 50%; width: 30px; height: 30px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>

    <div class="orb"></div>
    
    <div class="studio-card">
        <div class="brand-pill">Asset Engine</div>
        <h1 style="font-weight: 200; margin-top: 10px; font-size: 32px;">Render Lab</h1>
        <p style="font-size: 12px; color: #666; margin-top: 5px;">Paste code. The image below will live-update to a savable GIF.</p>

        <div class="layout">
            <textarea id="svg-input" placeholder="Paste <svg> markup..." oninput="process()"></textarea>
            
            <div class="output-container">
                <div id="loader"></div>
                <img id="final-image" alt="Rendered Output">
                <div id="hint" class="hint-text">Awaiting Input</div>
            </div>
        </div>
    </div>

    <canvas id="canvas" style="display:none"></canvas>

    <script>
        let debounceTimer;

        function process() {
            clearTimeout(debounceTimer);
            const input = document.getElementById('svg-input').value;
            const hint = document.getElementById('hint');
            const img = document.getElementById('final-image');
            const loader = document.getElementById('loader');

            if (!input.includes('<svg')) return;

            // Debounce so we don't fry the CPU while typing
            debounceTimer = setTimeout(async () => {
                hint.innerText = "RENDERING...";
                img.classList.remove('visible');
                loader.style.display = 'block';

                try {
                    const gifUrl = await convertToGif(input);
                    img.src = gifUrl;
                    img.classList.add('visible');
                    loader.style.display = 'none';
                    hint.innerText = "Right Click -> Save Image As";
                } catch (e) {
                    hint.innerText = "INVALID SVG CODE";
                    loader.style.display = 'none';
                }
            }, 800);
        }

        async function convertToGif(svgMarkup) {
            return new Promise((resolve, reject) => {
                const canvas = document.getElementById('canvas');
                const ctx = canvas.getContext('2d');
                
                const img = new Image();
                const svgBlob = new Blob([svgMarkup], {type: 'image/svg+xml;charset=utf-8'});
                const url = URL.createObjectURL(svgBlob);

                img.onload = () => {
                    canvas.width = img.width || 500;
                    canvas.height = img.height || 500;
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    ctx.drawImage(img, 0, 0);

                    const gif = new GIF({
                        workers: 2,
                        quality: 1,
                        workerScript: 'https://cdnjs.cloudflare.com/ajax/libs/gif.js/0.2.0/gif.worker.js'
                    });

                    // Add two frames for a valid GIF file
                    gif.addFrame(ctx, {copy: true, delay: 500});
                    gif.addFrame(ctx, {copy: true, delay: 500});

                    gif.on('finished', (blob) => {
                        resolve(URL.createObjectURL(blob));
                    });

                    gif.render();
                    URL.revokeObjectURL(url);
                };
                img.onerror = reject;
                img.src = url;
            });
        }
    </script>
</body>
</html>